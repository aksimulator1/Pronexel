@{
    Layout = null;
    ViewData["Title"] = "Login";
}
<!DOCTYPE html>
<html lang="zxx" class="js">

<head>
    <style>
        .ni-eye-alt {
            color: #ec9126;
            font-size: 18px;
        }
        .nk-menu-link.selected {
            background-color: white !important;
            color: black !important;
            border-color: black !important;
        }
    </style>

    <base href="../">
    <meta charset="utf-8">
    <meta name="author" content="Softnio">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title> Pronexel</title>

    <!-- CSS Files -->
    <link rel="stylesheet" href="~/newtheme/assets/css/dashlite.css?ver=2.5.0">
    <link id="skin-default" rel="stylesheet" href="~/newtheme/assets/css/theme.css?ver=2.5.0">
</head>

<body class="nk-body bg-lighter npc-general has-sidebar">
    <div class="nk-app-root">
        <div class="nk-main">
            <!-- Sidebar -->
            <div class="nk-sidebar nk-sidebar-fixed is-dark" data-content="sidebarMenu">
                <div class="nk-sidebar-element nk-sidebar-head" style="background-color:white;">
                    <div class="nk-menu-trigger">
                        <a href="#" class="nk-nav-toggle nk-quick-nav-icon d-xl-none" data-target="sidebarMenu"><em class="icon ni ni-arrow-left"></em></a>
                        <a href="#" class="nk-nav-compact nk-quick-nav-icon d-none d-xl-inline-flex" data-target="sidebarMenu"><em class="icon ni ni-menu"></em></a>
                    </div>
                    <div class="nk-sidebar-brand">
                        <a href="html/index.html" class="logo-link nk-sidebar-logo">
                            <img class="logo-light" style="width:8%" src="~/media/webimages/pronexel.png" alt="logo">
                            <img class="logo-dark" style="width:8%" src="~/media/webimages/pronexel.png" alt="logo-dark">
                        </a>
                    </div>
                </div>

                <div class="nk-sidebar-element nk-sidebar-body">
                    <div class="nk-sidebar-content">
                        <div class="nk-sidebar-menu" data-simplebar>
                            <ul class="nk-menu">
                                <li class="nk-menu-heading">
                                    <h6 class="overline-title text-primary-alt">Topics</h6>
                                </li>

                                @foreach (var chapter in ViewBag.ChapterType)
                                {
                                    <li class="nk-menu-item has-sub">
                                        <a href="#" class="nk-menu-link nk-menu-toggle">
                                            <span class="nk-menu-text">@chapter</span>
                                        </a>
                                        <ul class="nk-menu-sub">
                                            @foreach (var topic in ViewBag.Topic)
                                            {
                                                if (topic.CategoryType == chapter)
                                                {
                                                    <li class="nk-menu-item has-sub">
                                                        <a href="#" class="nk-menu-link nk-menu-toggle topic-link" data-id="@topic.ID" onclick="loadSubtopics(this, '@topic.ID')">
                                                            <span class="nk-menu-text">@topic.TopicName</span>
                                                        </a>
                                                        <ul class="nk-menu-sub" id="subtopics-container-@topic.ID"></ul>
                                                    </li>
                                                }
                                            }
                                        </ul>
                                    </li>
                                }
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
            <!-- /Sidebar -->

            <!-- Wrap -->
            <div class="nk-wrap">
                <!-- Header -->
                <div class="nk-header nk-header-fixed is-light">
                    <div class="container-fluid">
                        <div class="nk-header-wrap">
                            <div class="nk-menu-trigger d-xl-none ml-n1">
                                <a href="#" class="nk-nav-toggle nk-quick-nav-icon" data-target="sidebarMenu"><em class="icon ni ni-menu"></em></a>
                            </div>
                            <div class="nk-header-brand d-xl-none">
                                <a href="html/index.html" class="logo-link">
                                    <img class="logo-light logo-img" src="~/media/webimages/pronexel.png" alt="logo">
                                    <img class="logo-dark logo-img" src="~/media/webimages/pronexel.png" alt="logo-dark">
                                </a>
                            </div>
                            <div class="nk-header-tools">
                                <ul class="nk-quick-nav">
                                    <li class="dropdown user-dropdown">
                                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                                            <div class="user-toggle">
                                                <div class="user-avatar sm" style="background-color:#101924 !important"><em class="icon ni ni-user-alt"></em></div>
                                            </div>
                                        </a>
                                        <div class="dropdown-menu dropdown-menu-md dropdown-menu-right dropdown-menu-s1">
                                            <div class="dropdown-inner user-card-wrap bg-lighter d-none d-md-block">
                                                <div class="user-card">
                                                    <div class="user-avatar" style="background-color:#101924 !important"><span>  @User.Identity.Name.Substring(0, 1).ToUpper()</span></div>
                                                    <div class="user-info">
                                                        <span class="lead-text">@User.Identity.Name</span>
                                                
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="dropdown-inner">
                                                <ul class="link-list">
                                                    <li><a asp-action="Logout" asp-controller="Account"><em class="icon ni ni-signout"></em><span>Sign out</span></a></li>
                                                </ul>
                                            </div>
                                        </div>
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- /Header -->

                <!-- Main Content Area -->
                <div id="NewContent" style="position: relative; width: 100%; height: auto;margin-top:50px;">
                    <div style="opacity:30%">
                        <video autoplay muted loop playsinline style="width:100%; height:auto; object-fit:cover; position:absolute; top:0; left:0; z-index: 1;">
                            <source src="~/media/b45b93e4-b12d-48eb-9128-957c5b9168f9.mp4" type="video/mp4" />
                        </video>
                    </div>

                    <img src="~/media/webimages/pronexel.png" style="position: relative; z-index: 2; width: 36%;margin-left:33%;margin-top:10%" />
                    <h5 style="padding:20px;color:#101924;">
                        Pronexel offers expert technical consultancy and tailored solutions for oil & gas operators...
                    </h5>

                   @*  <a href="~/TrainingModule/Index" class="btn btn-lg" style="color:white;width:18%; margin-left:40%; background-color:#101924;">
                        Goto Course <em class="icon ni ni-arrow-right ml-1"></em>
                    </a> *@
                </div>
                <!-- /Main Content Area -->
            </div>
            <!-- /Wrap -->
        </div>
    </div>

    <!-- JavaScript -->
    <script src="~/newtheme/assets/js/bundle.js?ver=2.5.0"></script>
    <script src="~/newtheme/assets/js/scripts.js?ver=2.5.0"></script>
    <script>
        function loadSubtopics(element, topicId) {
            // Highlight selected topic
            document.querySelectorAll('.nk-menu-link.topic-link').forEach(el => el.classList.remove('selected'));
            element.classList.add('selected');

            $.ajax({
                url: '/JsonSide/AllSubCategroy',
                type: 'GET',
                data: { categoryId: topicId },
                success: function (subtopics) {
                    const container = document.getElementById(`subtopics-container-${topicId}`);
                    container.innerHTML = '';

                    subtopics.forEach((sub, index) => {
                        const li = document.createElement('li');
                        li.className = 'nk-menu-item';

                        const a = document.createElement('a');
                        a.className = 'nk-menu-link subtopic-link';
               
                        // 👁️ Add eye icon if viewStatus is true
                        const eyeIcon = sub.viewStatus ? '<em class="icon ni ni-eye-alt" style="margin-right: 5px;"></em>' : '';
                        a.innerHTML = `<span class="nk-menu-text">${sub.subTopicName}</span>${eyeIcon}`;

                        a.onclick = function () {
                            onSubtopicClick(this, topicId, sub.subTopicID);
                        };

                        li.appendChild(a);
                        container.appendChild(li);
                    });
                },
                error: function () {
                    console.error(`Failed to load subtopics for topic ${topicId}`);
                }
            });
        }

        function onSubtopicClick(element, topicId, subTopicId) {
            // Highlight selected subtopic
            document.querySelectorAll('.nk-menu-link.subtopic-link').forEach(el => el.classList.remove('selected'));
            element.classList.add('selected');

            const url = `/TrainingModule/AllMedia?TopicID=${encodeURIComponent(topicId)}&SubTopicID=${encodeURIComponent(subTopicId)}`;
            $("#NewContent").load(url);
        }
    </script>

</body>
</html>
